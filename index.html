<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Drywall Estimator - Advanced Blueprint Designer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Compact Header -->
        <header class="main-header compact">
            <div class="header-brand">
                <span class="brand-icon">üìê</span>
                <div class="brand-text">
                    <h1>Professional Drywall Estimator</h1>
                    <p class="tagline">Advanced Blueprint Designer</p>
                </div>
            </div>
            <div class="header-actions">
                <button id="new-project-btn" class="btn-icon" title="New Project">
                    <span>üìÑ</span>
                </button>
                <button id="load-project-btn" class="btn-icon" title="Load Project">
                    <span>üìÇ</span>
                </button>
                <button id="save-project-btn" class="btn-icon btn-primary" title="Save Project">
                    <span>üíæ</span>
                </button>
                <button id="help-btn" class="btn-icon" title="Help">
                    <span>‚ùì</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Collapsible Left Sidebar -->
            <aside class="sidebar sidebar-left collapsible" id="left-sidebar">
                <button class="sidebar-toggle" id="left-toggle" title="Toggle Tools Panel">
                    <span class="toggle-icon">‚óÄ</span>
                </button>

                <div class="sidebar-content">
                    <!-- Drawing Tools - Compact Grid -->
                    <div class="panel">
                        <div class="panel-header collapsible-header" data-panel="tools">
                            <h3>üõ†Ô∏è Drawing Tools</h3>
                            <span class="expand-icon">‚àí</span>
                        </div>
                        <div class="panel-content" id="tools-panel">
                            <div class="tool-grid compact">
                                <button class="tool-btn active compact" data-tool="select" title="Select/Move (V)">
                                    <span class="icon">‚Üñ</span>
                                    <span class="label">Select</span>
                                </button>
                                <button class="tool-btn compact" data-tool="wall-exterior" title="Exterior Wall (W)">
                                    <span class="icon">‚îÅ</span>
                                    <span class="label">Ext</span>
                                </button>
                                <button class="tool-btn compact" data-tool="wall-interior" title="Interior Wall (I)">
                                    <span class="icon">‚îÄ</span>
                                    <span class="label">Int</span>
                                </button>
                                <button class="tool-btn compact" data-tool="wall-partition" title="Partition (P)">
                                    <span class="icon">‚îÑ</span>
                                    <span class="label">Part</span>
                                </button>
                                <button class="tool-btn compact" data-tool="door-interior" title="Interior Door (D)">
                                    <span class="icon">üö™</span>
                                    <span class="label">Door</span>
                                </button>
                                <button class="tool-btn compact" data-tool="door-exterior" title="Exterior Door (E)">
                                    <span class="icon">üö™</span>
                                    <span class="label">Ext D</span>
                                </button>
                                <button class="tool-btn compact" data-tool="window-standard" title="Window (N)">
                                    <span class="icon">‚ñØ</span>
                                    <span class="label">Win</span>
                                </button>
                                <button class="tool-btn compact" data-tool="window-large" title="Large Window">
                                    <span class="icon">‚ñ≠</span>
                                    <span class="label">Lg Win</span>
                                </button>
                                <button class="tool-btn compact" data-tool="stairs-up" title="Stairs Up (U)">
                                    <span class="icon">‚¨Ü</span>
                                    <span class="label">Up</span>
                                </button>
                                <button class="tool-btn compact" data-tool="stairs-down" title="Stairs Down">
                                    <span class="icon">‚¨á</span>
                                    <span class="label">Down</span>
                                </button>
                                <button class="tool-btn compact" data-tool="room-auto" title="Auto Room (R)">
                                    <span class="icon">‚ñ°</span>
                                    <span class="label">Room</span>
                                </button>
                                <button class="tool-btn compact" data-tool="measure" title="Measure (M)">
                                    <span class="icon">üìè</span>
                                    <span class="label">Msre</span>
                                </button>
                                <button class="tool-btn compact" data-tool="text" title="Text (T)">
                                    <span class="icon">T</span>
                                    <span class="label">Text</span>
                                </button>
                                <button class="tool-btn compact" data-tool="erase" title="Erase (Del)">
                                    <span class="icon">‚å´</span>
                                    <span class="label">Erase</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- View Controls -->
                    <div class="panel">
                        <div class="panel-header collapsible-header" data-panel="view">
                            <h3>üëÅÔ∏è View</h3>
                            <span class="expand-icon">‚àí</span>
                        </div>
                        <div class="panel-content" id="view-panel">
                            <div class="btn-group-compact">
                                <button id="zoom-in-btn" class="btn-compact" title="Zoom In (+)">+</button>
                                <button id="zoom-out-btn" class="btn-compact" title="Zoom Out (-)">‚àí</button>
                                <button id="zoom-fit-btn" class="btn-compact" title="Fit (0)">‚ä°</button>
                                <button id="zoom-reset-btn" class="btn-compact" title="Reset">‚Ü∫</button>
                            </div>
                            <div class="options-compact">
                                <label><input type="checkbox" id="show-grid" checked><span>Grid</span></label>
                                <label><input type="checkbox" id="show-dimensions" checked><span>Dims</span></label>
                                <label><input type="checkbox" id="snap-to-grid" checked><span>Snap</span></label>
                                <label><input type="checkbox" id="show-room-labels" checked><span>Labels</span></label>
                            </div>
                        </div>
                    </div>

                    <!-- Floors -->
                    <div class="panel">
                        <div class="panel-header collapsible-header" data-panel="floors">
                            <h3>üè¢ Floors</h3>
                            <span class="expand-icon">‚àí</span>
                        </div>
                        <div class="panel-content" id="floors-panel">
                            <div id="floor-list" class="floor-list compact"></div>
                            <button id="add-floor-btn" class="btn-compact btn-block">+ Add Floor</button>
                        </div>
                    </div>

                    <!-- Layers -->
                    <div class="panel">
                        <div class="panel-header collapsible-header" data-panel="layers">
                            <h3>üé® Layers</h3>
                            <span class="expand-icon">+</span>
                        </div>
                        <div class="panel-content collapsed" id="layers-panel">
                            <div class="options-compact">
                                <label><input type="checkbox" id="layer-walls" checked><span class="layer-dot wall"></span><span>Walls</span></label>
                                <label><input type="checkbox" id="layer-doors" checked><span class="layer-dot door"></span><span>Doors</span></label>
                                <label><input type="checkbox" id="layer-windows" checked><span class="layer-dot window"></span><span>Windows</span></label>
                                <label><input type="checkbox" id="layer-stairs" checked><span class="layer-dot stairs"></span><span>Stairs</span></label>
                                <label><input type="checkbox" id="layer-rooms" checked><span class="layer-dot room"></span><span>Rooms</span></label>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="panel">
                        <div class="panel-header collapsible-header" data-panel="actions">
                            <h3>‚ö° Actions</h3>
                            <span class="expand-icon">+</span>
                        </div>
                        <div class="panel-content collapsed" id="actions-panel">
                            <button id="undo-btn" class="btn-compact btn-block" disabled>‚Ü∂ Undo</button>
                            <button id="redo-btn" class="btn-compact btn-block" disabled>‚Ü∑ Redo</button>
                            <button id="clear-all-btn" class="btn-compact btn-block btn-danger">üóëÔ∏è Clear</button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Canvas Area -->
            <main class="canvas-area">
                <!-- Floating Toolbar -->
                <div class="floating-toolbar">
                    <div class="toolbar-section">
                        <span id="current-floor-label" class="info-badge">Floor 1</span>
                        <span id="scale-label" class="info-badge">1"=1'</span>
                        <span id="zoom-label" class="info-badge">100%</span>
                    </div>
                    <div class="toolbar-section">
                        <span id="cursor-position" class="info-badge">X: 0', Y: 0'</span>
                        <span id="element-count" class="info-badge">0 elements</span>
                    </div>
                    <div class="toolbar-section">
                        <button id="export-image-btn" class="btn-compact" title="Export Image">üñºÔ∏è</button>
                        <button id="export-pdf-btn" class="btn-compact" title="Export PDF">üìÑ</button>
                    </div>
                </div>

                <!-- Canvas -->
                <div id="blueprint-container" class="blueprint-container">
                    <canvas id="grid-canvas"></canvas>
                    <canvas id="blueprint-canvas"></canvas>
                    <canvas id="overlay-canvas"></canvas>
                    <div id="canvas-tooltip" class="canvas-tooltip"></div>
                </div>

                <!-- Status Bar -->
                <div class="status-bar">
                    <span id="status-message">Ready</span>
                </div>
            </main>

            <!-- Collapsible Right Sidebar -->
            <aside class="sidebar sidebar-right collapsible" id="right-sidebar">
                <button class="sidebar-toggle" id="right-toggle" title="Toggle Properties Panel">
                    <span class="toggle-icon">‚ñ∂</span>
                </button>

                <div class="sidebar-content">
                    <!-- Compact Tabs -->
                    <div class="tabs-compact">
                        <button class="tab-btn compact active" data-tab="rooms" title="Rooms">üè†</button>
                        <button class="tab-btn compact" data-tab="materials" title="Materials">üí∞</button>
                        <button class="tab-btn compact" data-tab="estimate" title="Estimate">üßÆ</button>
                        <button class="tab-btn compact" data-tab="recommendations" title="Tips">üí°</button>
                    </div>

                    <!-- Rooms Tab -->
                    <div id="rooms-tab" class="tab-content active">
                        <div class="panel">
                            <div class="panel-header">
                                <h3>Rooms</h3>
                                <button id="add-room-manual-btn" class="btn-icon-sm">+</button>
                            </div>
                            <div id="rooms-list" class="rooms-list compact scrollable"></div>
                            <button id="detect-rooms-btn" class="btn-compact btn-block">üîç Auto-Detect</button>
                        </div>
                    </div>

                    <!-- Materials Tab -->
                    <div id="materials-tab" class="tab-content">
                        <div class="panel scrollable">
                            <div class="panel-header collapsible-header" data-panel="pricing">
                                <h3>üí∞ Pricing</h3>
                                <span class="expand-icon">‚àí</span>
                            </div>
                            <div class="panel-content" id="pricing-panel">
                                <div class="form-group-compact">
                                    <label>Preset</label>
                                    <select id="price-preset-select" class="input-compact">
                                        <option value="custom">Custom</option>
                                        <option value="national-standard">National Avg</option>
                                        <option value="national-premium">Premium</option>
                                        <option value="national-economy">Economy</option>
                                        <option value="northeast-standard">Northeast</option>
                                        <option value="southeast-standard">Southeast</option>
                                        <option value="midwest-standard">Midwest</option>
                                        <option value="southwest-standard">Southwest</option>
                                        <option value="west-standard">West Coast</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="panel scrollable">
                            <div class="panel-header collapsible-header" data-panel="drywall-prices">
                                <h3>Drywall</h3>
                                <span class="expand-icon">+</span>
                            </div>
                            <div class="panel-content collapsed" id="drywall-prices-panel">
                                <div class="form-group-compact">
                                    <label>1/2" Standard</label>
                                    <input type="number" id="price-drywall-standard" value="15.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>5/8" Fire-Rated</label>
                                    <input type="number" id="price-drywall-firerated" value="18.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Moisture-Resistant</label>
                                    <input type="number" id="price-drywall-moisture" value="22.50" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Type X</label>
                                    <input type="number" id="price-drywall-typex" value="20.00" step="0.01" class="input-compact">
                                </div>
                            </div>
                        </div>

                        <div class="panel scrollable">
                            <div class="panel-header collapsible-header" data-panel="finish-prices">
                                <h3>Finishing</h3>
                                <span class="expand-icon">+</span>
                            </div>
                            <div class="panel-content collapsed" id="finish-prices-panel">
                                <div class="form-group-compact">
                                    <label>Joint Compound</label>
                                    <input type="number" id="price-mud" value="20.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Paper Tape</label>
                                    <input type="number" id="price-tape-paper" value="8.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Mesh Tape</label>
                                    <input type="number" id="price-tape-mesh" value="12.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Screws ($/lb)</label>
                                    <input type="number" id="price-screws" value="8.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Corner Bead</label>
                                    <input type="number" id="price-cornerbead-metal" value="5.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Bullnose Bead</label>
                                    <input type="number" id="price-cornerbead-bullnose" value="7.50" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Primer</label>
                                    <input type="number" id="price-primer" value="35.00" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Texture</label>
                                    <input type="number" id="price-texture" value="15.00" step="0.01" class="input-compact">
                                </div>
                            </div>
                        </div>

                        <div class="panel scrollable">
                            <div class="panel-header collapsible-header" data-panel="labor-rates">
                                <h3>Labor</h3>
                                <span class="expand-icon">+</span>
                            </div>
                            <div class="panel-content collapsed" id="labor-rates-panel">
                                <div class="form-group-compact">
                                    <label>Hanging ($/sq ft)</label>
                                    <input type="number" id="labor-hanging" value="0.80" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Taping ($/sq ft)</label>
                                    <input type="number" id="labor-taping" value="0.90" step="0.01" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Finishing ($/sq ft)</label>
                                    <input type="number" id="labor-finishing" value="0.80" step="0.01" class="input-compact">
                                </div>
                            </div>
                        </div>

                        <div class="panel scrollable">
                            <div class="panel-header collapsible-header" data-panel="project-settings">
                                <h3>Settings</h3>
                                <span class="expand-icon">+</span>
                            </div>
                            <div class="panel-content collapsed" id="project-settings-panel">
                                <div class="form-group-compact">
                                    <label>Waste Factor (%)</label>
                                    <input type="number" id="waste-factor" value="10" step="1" class="input-compact">
                                </div>
                                <div class="form-group-compact">
                                    <label>Markup (%)</label>
                                    <input type="number" id="markup-percent" value="20" step="1" class="input-compact">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estimate Tab -->
                    <div id="estimate-tab" class="tab-content">
                        <div class="panel">
                            <div class="panel-header">
                                <h3>Estimate</h3>
                                <button id="calculate-estimate-btn" class="btn-icon-sm btn-success">üßÆ</button>
                            </div>

                            <div class="estimate-results scrollable">
                                <div class="stat-card compact">
                                    <div class="stat-label">Wall Area</div>
                                    <div class="stat-value" id="est-wall-area">0 sq ft</div>
                                </div>
                                <div class="stat-card compact">
                                    <div class="stat-label">Ceiling Area</div>
                                    <div class="stat-value" id="est-ceiling-area">0 sq ft</div>
                                </div>
                                <div class="stat-card compact">
                                    <div class="stat-label">Stairwell</div>
                                    <div class="stat-value" id="est-stair-area">0 sq ft</div>
                                </div>
                                <div class="stat-card compact highlight">
                                    <div class="stat-label">Total</div>
                                    <div class="stat-value" id="est-total-area">0 sq ft</div>
                                </div>

                                <div class="divider"></div>

                                <div class="panel-header collapsible-header" data-panel="materials-breakdown">
                                    <h4>Materials</h4>
                                    <span class="expand-icon">‚àí</span>
                                </div>
                                <div class="panel-content" id="materials-breakdown-panel">
                                    <div id="materials-breakdown"></div>
                                </div>

                                <div class="divider"></div>

                                <div class="stat-card compact">
                                    <div class="stat-label">Materials</div>
                                    <div class="stat-value" id="est-materials-cost">$0</div>
                                </div>
                                <div class="stat-card compact">
                                    <div class="stat-label">Labor</div>
                                    <div class="stat-value" id="est-labor-cost">$0</div>
                                </div>
                                <div class="stat-card compact">
                                    <div class="stat-label">Markup</div>
                                    <div class="stat-value" id="est-markup">$0</div>
                                </div>
                                <div class="stat-card compact total">
                                    <div class="stat-label">Total</div>
                                    <div class="stat-value" id="est-total">$0</div>
                                </div>

                                <div class="btn-group-vertical">
                                    <button id="export-estimate-btn" class="btn-compact btn-block">üíæ Export</button>
                                    <button id="print-estimate-btn" class="btn-compact btn-block">üñ®Ô∏è Print</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recommendations Tab -->
                    <div id="recommendations-tab" class="tab-content">
                        <div class="panel">
                            <div class="panel-header">
                                <h3>Smart Tips</h3>
                            </div>
                            <div id="recommendations-list" class="recommendations-list scrollable">
                                <div class="tip-card info">
                                    <span class="tip-icon">üí°</span>
                                    <div class="tip-content">
                                        <strong>Welcome!</strong>
                                        <p>Start drawing. Tips appear as you work.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Modals -->
    <div id="room-modal" class="modal">
        <div class="modal-content modal-compact">
            <div class="modal-header">
                <h2>Room Properties</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body scrollable">
                <div class="form-grid-compact">
                    <div class="form-group-compact">
                        <label>Name</label>
                        <input type="text" id="room-name" placeholder="Living Room" class="input-compact">
                    </div>
                    <div class="form-group-compact">
                        <label>Type</label>
                        <select id="room-type" class="input-compact">
                            <option value="living">Living Room</option>
                            <option value="bedroom">Bedroom</option>
                            <option value="kitchen">Kitchen</option>
                            <option value="bathroom">Bathroom</option>
                            <option value="dining">Dining Room</option>
                            <option value="office">Office</option>
                            <option value="garage">Garage</option>
                            <option value="basement">Basement</option>
                            <option value="hallway">Hallway</option>
                            <option value="utility">Utility</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group-compact">
                        <label>Width (ft)</label>
                        <input type="number" id="room-width" value="12" step="0.5" class="input-compact">
                    </div>
                    <div class="form-group-compact">
                        <label>Length (ft)</label>
                        <input type="number" id="room-length" value="15" step="0.5" class="input-compact">
                    </div>
                    <div class="form-group-compact">
                        <label>Height (ft)</label>
                        <input type="number" id="room-height" value="8" step="0.5" class="input-compact">
                    </div>
                    <div class="form-group-compact">
                        <label>Ceiling Type</label>
                        <select id="room-ceiling-type" class="input-compact">
                            <option value="standard">Standard Flat</option>
                            <option value="vaulted">Vaulted</option>
                            <option value="tray">Tray</option>
                            <option value="coffered">Coffered</option>
                            <option value="none">No Ceiling</option>
                        </select>
                    </div>
                    <div class="form-group-compact">
                        <label>Drywall Type</label>
                        <select id="room-drywall-type" class="input-compact">
                            <option value="standard">Standard</option>
                            <option value="moisture">Moisture-Resistant</option>
                            <option value="firerated">Fire-Rated</option>
                            <option value="typex">Type X</option>
                        </select>
                    </div>
                    <div class="form-group-compact">
                        <label>Finish Level</label>
                        <select id="room-finish-level" class="input-compact">
                            <option value="level0">Level 0</option>
                            <option value="level1">Level 1</option>
                            <option value="level2">Level 2</option>
                            <option value="level3">Level 3</option>
                            <option value="level4" selected>Level 4</option>
                            <option value="level5">Level 5</option>
                        </select>
                    </div>
                </div>
                <div class="options-compact">
                    <label><input type="checkbox" id="room-include-ceiling" checked><span>Include Ceiling</span></label>
                    <label><input type="checkbox" id="room-include-texture"><span>Add Texture</span></label>
                    <label><input type="checkbox" id="room-include-primer" checked><span>Include Primer</span></label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="room-cancel-btn" class="btn-compact">Cancel</button>
                <button id="room-save-btn" class="btn-compact btn-primary">Save</button>
            </div>
        </div>
    </div>

    <div id="help-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Help & Shortcuts</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body scrollable">
                <div class="help-section">
                    <h3>üéπ Keyboard Shortcuts</h3>
                    <div class="shortcuts-grid">
                        <div><kbd>V</kbd> Select/Move</div>
                        <div><kbd>W</kbd> Exterior Wall</div>
                        <div><kbd>I</kbd> Interior Wall</div>
                        <div><kbd>P</kbd> Partition</div>
                        <div><kbd>D</kbd> Interior Door</div>
                        <div><kbd>E</kbd> Exterior Door</div>
                        <div><kbd>N</kbd> Window</div>
                        <div><kbd>U</kbd> Stairs Up</div>
                        <div><kbd>M</kbd> Measure</div>
                        <div><kbd>T</kbd> Text</div>
                        <div><kbd>Del</kbd> Delete</div>
                        <div><kbd>Ctrl+Z</kbd> Undo</div>
                        <div><kbd>Ctrl+Y</kbd> Redo</div>
                        <div><kbd>Ctrl+S</kbd> Save</div>
                        <div><kbd>+</kbd> / <kbd>-</kbd> Zoom</div>
                        <div><kbd>0</kbd> Fit View</div>
                    </div>
                </div>
                <div class="help-section">
                    <h3>üñ±Ô∏è Mouse Controls</h3>
                    <ul class="help-list">
                        <li><strong>Click & Drag:</strong> Draw elements</li>
                        <li><strong>Double-Click Wall:</strong> Add door/window</li>
                        <li><strong>Mouse Wheel:</strong> Zoom in/out</li>
                        <li><strong>Middle Button:</strong> Pan canvas</li>
                        <li><strong>Ctrl+Click:</strong> Multi-select</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h3>üí° Quick Tips</h3>
                    <ul class="help-list">
                        <li>Enable <strong>Snap to Grid</strong> for precision</li>
                        <li>Use <strong>Auto-Detect Rooms</strong> after drawing walls</li>
                        <li>Check <strong>Smart Tips</strong> tab for recommendations</li>
                        <li>Save often - autosaves every 60 seconds</li>
                        <li>Collapse panels for more drawing space</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-compact btn-primary modal-close">Got It!</button>
            </div>
        </div>
    </div>

    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>Loading...</p>
    </div>

    <script src="utils.js"></script>
    <script src="calculator.js"></script>
    <script src="recommendations.js"></script>
    <script src="blueprint.js"></script>
    <script src="app.js"></script>
</body>
</html>
